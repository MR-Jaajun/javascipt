"use strict";$(function(){var e=location.search.slice(1);function t(){var t=$(".main").find(".big-img").children().eq(0).attr("src"),i=$(".main").find("h1").html(),n=$(".main").find(".content .summary-price b").html(),s=$("#p_number").val();$.ajax({type:"post",url:"../api/car.php",async:!0,data:{gid:e,gimg:t,ginfo:i,gprice:n,quantity:s},success:function(t){var i=JSON.parse(t),n=i.total[0]["SUM(quantity)"],s=i.sPrice[0]["SUM(sumprice)"];$(".totleNum b").html(n),$(".totlePrice").html(s)}})}$.ajax({type:"get",url:"../api/list.php",async:!0,data:{page:1,gid:e},success:function(t){!function(t){var i=JSON.parse(t).glist.map(function(t){return'<div class="crumbs">\n\t\t\t\t\t\t<a class="ml0" href="/">首页</a>&gt;\n\t\t\t\t\t\t<a href="list.html">进口水果</a>&gt;\n\t\t\t\t\t\t<span>'+t.ginfo+'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="content clearfix">\n\t\t\t\t\t\t<div class="product-img clearfix">\n\t\t\t\t\t\t\t<div class="big-img">\n\t\t\t\t\t\t\t\t<img src="'+t.dimg1+'" class="on"/>\n\t\t\t\t\t\t\t\t<img src="'+t.dimg2+'" />\n\t\t\t\t\t\t\t\t<img src="'+t.dimg3+'" />\n\t\t\t\t\t\t\t\t<div id="move"></div>\n\t\t\t\t\t\t\t\t<div class="imgbox"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="fdj">\n\t\t\t\t\t\t\t\t<img src="'+t.dimg1+'" class="big-on"/>\n\t\t\t\t\t\t\t\t<img src="'+t.dimg2+'" />\n\t\t\t\t\t\t\t\t<img src="'+t.dimg3+'" />\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="small-img">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t<li><img src="'+t.dimg1+'" /></li>\n\t\t\t\t\t\t\t\t\t<li><img src="'+t.dimg2+'" /></li>\n\t\t\t\t\t\t\t\t\t<li><img src="'+t.dimg3+'" /></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="product-info">\n\t\t\t\t\t\t\t<div class="summary-name">\n\t\t\t\t\t\t\t\t<h1>'+t.ginfo+"</h1>\n\t\t\t\t\t\t\t\t<p>"+t.gdescribe+'</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="summary-price clearfix">\n\t\t\t\t\t\t\t\t<div class="pro-price">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<span class="tt">价格：</span>\n\t\t\t\t\t\t\t\t\t\t<span><i>¥</i><b>'+t.gprice+'</b></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="pro-m2">更多商品优惠，尽在易果生鲜APP</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t<div class="summary-other clearfix">\n\t\t\t\t\t\t<div class="left">\n\t\t\t\t\t\t\t<div class="choose clearfix">\n\t\t\t\t\t\t\t\t<div class="dt">规格：</div>\n\t\t\t\t\t\t\t\t<div class="dd">\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li class="selected">\n\t\t\t\t\t\t\t\t\t\t\t<a href="">\n\t\t\t\t\t\t\t\t\t\t\t\t<span>￥'+t.gprice+'</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span>500g/盒</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="pro-service">满百包邮，<b>20:00</b> 前完成订单 预计明日<b>(5月16日)</b>送达</div>\n\t\t\t\t\t\t\t<div class="pro-service">\n\t\t\t\t\t\t\t\t<i class="mr5"><img src="../img/listimg/icon1.png"></i>\n\t\t\t\t\t\t\t\t不支持7天无理由退货\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>'}).join("");$("#main .main").html(i)}(t)}}),$(".main").on("click",".content .product-img ul li",function(){var t=$(this).index();$(this).parent().parent().parent().find(".big-img img").eq(t).addClass("on").siblings().removeClass("on"),$(this).parent().parent().parent().find(".fdj img").eq(t).addClass("big-on").siblings().removeClass("big-on")}),$(".main").on("mouseenter",".imgbox",function(){$(this).parent().find("#move").css("display","block"),$(this).parent().parent().find(".fdj").css("display","block")}),$(".main").on("mouseleave",".imgbox",function(){$(this).parent().find("#move").css("display","none"),$(this).parent().parent().find(".fdj").css("display","none")}),$(".main").on("mousemove",".imgbox",function(t){var i=t.clientX-$(this).offset().left-$(this).parent().find("#move").outerWidth()/2,n=t.clientY-$(this).offset().top-$(this).parent().find("#move").outerHeight()/2;i<0?i=0:i>$(this).outerWidth()-$(this).parent().find("#move").outerWidth()&&(i=$(this).outerWidth()-$(this).parent().find("#move").outerWidth()),n<0?n=0:n>$(this).outerHeight()-$(this).parent().find("#move").outerHeight()&&(n=$(this).outerHeight()-$(this).parent().find("#move").outerHeight()),$(this).parent().find("#move").css("left",i),$(this).parent().find("#move").css("top",n);var s=i/($(this).outerWidth()-$(this).parent().find("#move").outerWidth()),e=n/($(this).outerHeight()-$(this).parent().find("#move").outerHeight()),a=-s*($(this).parent().parent().find(".fdj img").outerWidth()-$(this).parent().parent().find(".fdj").outerWidth()),r=-e*($(this).parent().parent().find(".fdj img").outerHeight()-$(this).parent().parent().find(".fdj").outerHeight());$(this).parent().parent().find(".fdj img").css("left",a),$(this).parent().parent().find(".fdj img").css("top",r)}),$("#main .decrease").click(function(){var t=$("#p_number").val();--t<1&&(t=1),$("#p_number").val(t)}),$("#main .increase").click(function(){var t=$("#p_number").val();t++,$("#p_number").val(t)}),t(),$("#main").on("click",".btn-gn",function(){t()})});